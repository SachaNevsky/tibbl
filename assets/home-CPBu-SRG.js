import{a as n,p as a,w as M}from"./chunk-EPOLDU6W-CP3WDhNt.js";const C="https://raw.githubusercontent.com/armbennett/tangible-11ty/main",v=[{value:"Numbers",label:"Numbers"},{value:"MusicLoops1",label:"Music Loops 1"},{value:"Mystery",label:"Mystery"},{value:"Notifications",label:"Notifications"},{value:"OdeToJoy",label:"Ode to Joy"},{value:"FurElise",label:"Fur Elise"}];function A(){const[o,y]=n.useState(!1),[c,x]=n.useState(null),[p,j]=n.useState(""),[E,w]=n.useState(!0),[d,T]=n.useState(["Numbers","Numbers","Numbers"]),[s,R]=n.useState(null),[r,u]=n.useState(!1),m=n.useRef(null),N=n.useRef(null),k=()=>{y(!o)},h=(e,t,l)=>{const f=new window.Howl({src:[`${C}/assets/sound/${t}.mp3`],volume:.2,sprite:e.soundSets[t]});e.threads[l]=f},b=(e,t)=>{const l=[...d];l[e]=t,T(l),s&&h(s,t,e)};n.useEffect(()=>{(async()=>{try{const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js",document.head.appendChild(t),await new Promise(g=>{t.onload=()=>g()});const i=(await(await fetch(`${C}/assets/js/tangible.js`)).text()).replace("export default class Tangible","window.Tangible = class Tangible"),S=document.createElement("script");if(S.textContent=i,document.head.appendChild(S),window.Tangible){const g=new window.Tangible;R(g)}w(!1)}catch(t){console.error("Error loading scripts:",t),w(!1)}})()},[]),n.useEffect(()=>{if(s&&o&&N.current)try{s.setupTangible()}catch(e){console.error("Error setting up tangible:",e)}},[s,o]),n.useEffect(()=>{s&&(h(s,"Numbers",0),h(s,"Numbers",1),h(s,"Numbers",2))},[s]);const L=()=>{if(!s){console.error("Tangible instance not initialized");return}if(r){s.synthesis.cancel(),u(!1);return}if(s.isAudioPlaying()){s.stopAllSounds();return}if(o){const e=s.scanCode();e&&j(e)}if(p){u(!0);const e=p.toLowerCase().split(`
`);let t=0;e.forEach((l,f)=>{const i=new SpeechSynthesisUtterance(l);i.onend=()=>{t++,t===e.length&&u(!1)},i.onerror=()=>{t++,t===e.length&&u(!1)},s.synthesis.speak(i)})}};return n.useEffect(()=>(o?navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}).then(e=>{x(e),m.current&&(m.current.srcObject=e)}).catch(e=>{console.error("Error accessing camera:",e)}):c&&(c.getTracks().forEach(e=>e.stop()),x(null)),()=>{c&&c.getTracks().forEach(e=>e.stop())}),[o]),n.useEffect(()=>{if(!o)return;const e=t=>{t.touches.length===3&&(t.preventDefault(),console.log("Run button triggered by three-finger touch"))};return document.addEventListener("touchstart",e),()=>{document.removeEventListener("touchstart",e)}},[o]),a.jsxs("div",{className:"app-container",children:[a.jsxs("header",{className:"header",role:"banner",children:[a.jsx("div",{className:"logo-container",children:a.jsx("img",{src:"https://armbennett.github.io/tangible-11ty/assets/img/tibbl-logo.png",alt:"Application logo",className:"logo"})}),a.jsxs("nav",{className:"header-buttons",role:"navigation","aria-label":"Main navigation",children:[a.jsxs("button",{className:"header-button",onClick:k,"aria-label":o?"Disable camera":"Enable camera","aria-pressed":o,children:[a.jsx("i",{className:"fa-solid fa-camera fa-2xl","aria-hidden":"true"}),a.jsx("span",{children:"Camera"})]}),a.jsxs("button",{className:"header-button","aria-label":"Run code",children:[a.jsx("i",{className:"fa-solid fa-play fa-2xl","aria-hidden":"true"}),a.jsx("span",{children:"Play/Stop"})]}),a.jsxs("button",{className:"header-button",onClick:L,"aria-label":r?"Stop reading code":"Read out code text","aria-pressed":r,disabled:E||!s,style:r?{backgroundColor:"#aac9eb",color:"#ffffff"}:void 0,children:[a.jsx("i",{className:"fa-brands fa-readme fa-2xl","aria-hidden":"true"}),a.jsx("span",{children:r?"Stop":"Read"})]})]})]}),o&&a.jsx("section",{className:"camera-section",role:"region","aria-label":"Camera view section",children:a.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[a.jsx("video",{ref:m,autoPlay:!0,playsInline:!0,className:"camera-video","aria-label":"Live camera feed from back camera"}),a.jsx("canvas",{ref:N,id:"video-canvas","aria-label":"Code tile detection overlay showing detected code tiles",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"}})]})}),a.jsxs("section",{className:`output-section ${o?"camera-active":""}`,role:"region","aria-label":"Code output and thread selection",children:[a.jsx("div",{className:"textbox-container",children:a.jsx("textarea",{value:p,onChange:e=>j(e.target.value),className:"output-textbox",placeholder:`thread 1
loop 3 times
play 2
end loop`,"aria-label":"Code output text area"})}),a.jsxs("div",{className:"dropdown-container",children:[a.jsxs("div",{className:"dropdown-group",children:[a.jsx("label",{htmlFor:"thread1",className:"dropdown-label",children:"Thread 1"}),a.jsx("select",{id:"thread1",className:"dropdown",value:d[0],onChange:e=>b(0,e.target.value),"aria-label":"Select Thread 1 sound options",children:v.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("div",{className:"dropdown-group",children:[a.jsx("label",{htmlFor:"thread2",className:"dropdown-label",children:"Thread 2"}),a.jsx("select",{id:"thread2",className:"dropdown",value:d[1],onChange:e=>b(1,e.target.value),"aria-label":"Select Thread 2 sound options",children:v.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("div",{className:"dropdown-group",children:[a.jsx("label",{htmlFor:"thread3",className:"dropdown-label",children:"Thread 3"}),a.jsx("select",{id:"thread3",className:"dropdown",value:d[2],onChange:e=>b(2,e.target.value),"aria-label":"Select Thread 3 sound options",children:v.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]})]})]})]})}function H({}){return[{title:"New React Router App"},{name:"description",content:"Welcome to React Router!"}]}const I=M(function(){return a.jsx(A,{})});export{I as default,H as meta};
